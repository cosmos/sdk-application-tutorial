---
order: 9
---

# Walkthrough

The software is ready. Now you can go through buying and selling a Token.

If you have started some tests with the relayer before, make sure to clear your old data with

```bash
rm -rf ~/.relayer
```

To start the networks

```bash
// start networks
starport serve -c mars.yml -r
starport serve -c venus.yml -r
```

Configure the relayer

```bash
// relayer configuration
starport relayer configure -a --source-rpc "http://0.0.0.0:26657" --source-faucet "http://0.0.0.0:4500" --source-port "ibcdex" --source-version "ibcdex-1" --target-rpc "http://0.0.0.0:26659" --target-faucet "http://0.0.0.0:4501" --target-port "ibcdex" --target-version "ibcdex-1"
```

Connect the relayer

```
// relayer connection
starport relayer connect
```

Commands available with our new module

```go
// To get account balances during the tutorial:
// For mars
interchanged q bank balances [address]

// For venus
interchanged q bank balances [address] --node tcp://localhost:26659

// To show the order book
// For mars
interchanged q ibcdex list-sellOrderBook

// For venus
interchanged q ibcdex list-buyOrderBook --node tcp://localhost:26659
```

Create a new pair for an exchange

```bash
// create the pair
interchanged tx ibcdex send-createPair ibcdex channel-0 mcx vcx --from alice --chain-id mars --home ~/.mars
```

Display current order books available

```bash
// show the order books
interchanged q ibcdex list-sellOrderBook
interchanged q ibcdex list-buyOrderBook --node tcp://localhost:26659
```

## Create a sell order

Command generated by `packet` starport command:

`interchanged tx ibcdex send-sellOrder [src-port] [src-channel] [amountDenom] [amount] [priceDenom] [price]`

```
// Send the sell order
interchanged tx ibcdex send-sellOrder ibcdex channel-0 mcx 10 vcx 15 --from alice --chain-id mars --home ~/.mars
```

## Create a buy order

`interchanged tx ibcdex send-buyOrder [src-port] [src-channel] [amountDenom] [amount] [priceDenom] [price]`

```
// Send buy order
interchanged tx ibcdex send-buyOrder ibcdex channel-0 mcx 10 vcx 5 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659
```

## Cancel an order

`interchanged tx ibcdex cancelSellOrder [port] [channel] [amountDenom] [priceDenom] [orderID]`

`interchanged tx ibcdex cancelBuyOrder [port] [channel] [amountDenom] [priceDenom] [orderID]`

```go
// Sell order
interchanged tx ibcdex cancelSellOrder ibcdex channel-0 mcx vcx 0 --from alice --chain-id mars --home ~/.mars

// Buy order
interchanged tx ibcdex cancelBuyOrder ibcdex channel-0 mcx vcx 3 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659
```

## Example tests

```go
// Sell order
interchanged tx ibcdex send-sellOrder ibcdex channel-0 mcx 10 vcx 15 --from alice --chain-id mars --home ~/.mars

// Sell order book
interchanged q ibcdex list-sellOrderBook

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 2
  orders:
  - amount: 10
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 0
    price: 15
  priceDenom: vcx
pagination:
  next_key: null
  total: "1"

// Buy order
interchanged tx ibcdex send-buyOrder ibcdex channel-0 mcx 10 vcx 5 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

// Buy order book
interchanged q ibcdex list-buyOrderBook --node tcp://localhost:26659

BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 3
  orders:
  - amount: 10
    creator: cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz
    id: 1
    price: 5
  priceDenom: vcx
pagination:
  next_key: null
  total: "1"

// Perform a sell order that get completely filled
interchanged tx ibcdex send-sellOrder ibcdex channel-0 mcx 5 vcx 3 --from alice --chain-id mars --home ~/.mars

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 2
  orders:
  - amount: 10
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 0
    price: 15
  priceDenom: vcx
BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 3
  orders:
  - amount: 5
    creator: cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz
    id: 1
    price: 5
  priceDenom: vcx

// Get balance
interchanged q bank balances cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f

balances:
- amount: "25"
  denom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
- amount: "985"
  denom: mcx
- amount: "0"
  denom: stake
- amount: "1000"
  denom: token
pagination:
  next_key: null
  total: "0"

// Filled buy order
interchanged tx ibcdex send-buyOrder ibcdex channel-0 mcx 5 vcx 15 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 2
  orders:
  - amount: 5
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 0
    price: 15
  priceDenom: vcx
BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 3
  orders:
  - amount: 5
    creator: cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz
    id: 1
    price: 5
  priceDenom: vcx

interchanged q bank balances cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f

balances:
- amount: "100"
  denom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
- amount: "985"
  denom: mcx
- amount: "0"
  denom: stake
- amount: "1000"
  denom: token

interchanged q bank balances cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz --node tcp://localhost:26659

balances:
- amount: "10"
  denom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
- amount: "900000000"
  denom: stake
- amount: "1000"
  denom: token
- amount: "875"
  denom: vcx

// Sell order that gets partially filled
interchanged tx ibcdex send-sellOrder ibcdex channel-0 mcx 10 vcx 3 --from alice --chain-id mars --home ~/.mars

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 4
  orders:
  - amount: 5
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 0
    price: 15
  - amount: 5
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 2
    price: 3
  priceDenom: vcx
BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 3
  orders: []
  priceDenom: vcx

interchanged q bank balances cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f

balances:
- amount: "125"
  denom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
- amount: "975"
  denom: mcx
- amount: "0"
  denom: stake
- amount: "1000"
  denom: token

// Buy order that gets partially filled
interchanged tx ibcdex send-buyOrder ibcdex channel-0 mcx 10 vcx 5 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 4
  orders:
  - amount: 5
    creator: cosmos1hfdsvk3rl3a7rfgxvnetnnfvpvjxtrjmwrym3f
    id: 0
    price: 15
  priceDenom: vcx
BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 5
  orders:
  - amount: 5
    creator: cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz
    id: 3
    price: 5
  priceDenom: vcx

interchanged q bank balances cosmos1uhgh5hk8hdmqg8dl8kwfx2c6jxg6ymq7x8h8fz --node tcp://localhost:26659

balances:
- amount: "20"
  denom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
- amount: "900000000"
  denom: stake
- amount: "1000"
  denom: token
- amount: "825"
  denom: vcx

// Cancel a sell order
interchanged tx ibcdex cancelSellOrder ibcdex channel-0 mcx vcx 0 --from alice --chain-id mars --home ~/.mars

SellOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 4
  orders: []
  priceDenom: vcx

// Cancel a buy order
interchanged tx ibcdex cancelBuyOrder ibcdex channel-0 mcx vcx 3 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

BuyOrderBook:
- amountDenom: mcx
  index: ibcdex-channel-0-mcx-vcx
  orderIDTrack: 5
  orders: []
  priceDenom: vcx
```

### Exchanging tokens and returning them back

```go
// Exchange mcx and vcx
interchanged tx ibcdex send-createPair ibcdex channel-0 mcx vcx --from alice --chain-id mars --home ~/.mars
interchanged tx ibcdex send-sellOrder ibcdex channel-0 mcx 10 vcx 15 --from alice --chain-id mars --home ~/.mars
interchanged tx ibcdex send-buyOrder ibcdex channel-0 mcx 10 vcx 15 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

interchanged q bank balances cosmos1d745lvvgnrcuzggeze0du30vsdg3y0fmq7p5ct

balances:
- amount: "150"
  denom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
- amount: "990"
  denom: mcx
- amount: "0"
  denom: stake
- amount: "1000"
  denom: token

interchanged q bank balances cosmos14r4pkeat7v6r5n5msr4a33c8lptqrryqau3zrg  --node tcp://localhost:26659

balances:
- amount: "10"
  denom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
- amount: "900000000"
  denom: stake
- amount: "1000"
  denom: token
- amount: "850"
  denom: vcx

// We can see on each chain the saved trace denom
interchanged q ibcdex list-denomTrace

DenomTrace:
- channel: channel-0
  index: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
  origin: mcx
  port: ibcdex

interchanged q ibcdex list-denomTrace --node tcp://localhost:26659

DenomTrace:
- channel: channel-0
  index: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
  origin: vcx
  port: ibcde

// Create a pair in the opposite way
interchanged tx ibcdex send-createPair ibcdex channel-0 ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833 ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33 --from alice --chain-id mars --home ~/.mars

// On Mars:
SellOrderBook:
- amountDenom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
  index: ibcdex-channel-0-ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833-ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
  orderIDTrack: 0
  orders: []
  priceDenom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33

// On Venus
BuyOrderBook:
- amountDenom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
  index: ibcdex-channel-0-ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833-ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
  orderIDTrack: 1
  orders: []
  priceDenom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33

// Exchange tokens back
interchanged tx ibcdex send-sellOrder ibcdex channel-0 ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833 10 ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33 1 --from alice --chain-id mars --home ~/.mars
interchanged tx ibcdex send-buyOrder ibcdex channel-0 ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833 5 ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33 1 --from alice --chain-id venus --home ~/.venus --node tcp://localhost:26659

interchanged q bank balances cosmos1d745lvvgnrcuzggeze0du30vsdg3y0fmq7p5ct

balances:
- amount: "140"
  denom: ibc/50D70B7748FB8AA69F09114EC9E5615C39E07381FE80E628A1AF63A6F5C79833
- amount: "995"
  denom: mcx
- amount: "0"
  denom: stake
- amount: "1000"
  denom: token

interchanged q bank balances cosmos14r4pkeat7v6r5n5msr4a33c8lptqrryqau3zrg  --node tcp://localhost:26659

balances:
- amount: "5"
  denom: ibc/99678A10AF684E33E88959727F2455AE42CCC64CD76ECFA9691E1B5A32342D33
- amount: "900000000"
  denom: stake
- amount: "1000"
  denom: token
- amount: "855"
  denom: vcx

// We can get our tokens back !!!!!
```